import {verify, decode, }from 'jsonwebtoken'

export const GOOGLE_PUBLIC_KEYS: any = {}
GOOGLE_PUBLIC_KEYS["88848b5aff2d5201331a547d1906e5aadf6513c8"] = "-----BEGIN CERTIFICATE-----\nMIIDHDCCAgSgAwIBAgIIA/oH1w0GNmMwDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UE\nAxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMjAw\nNDI3MDkxOTU2WhcNMjAwNTEzMjEzNDU2WjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tl\nbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD\nggEPADCCAQoCggEBAJ0JeaPobguFV56+uzblHTomAFVcixD2fyERU4x618fxuTRq\nEBCZErH3SeUIR0KH8KIbjBYcF8DVZLF0xWSAIhVCbcp1t+53ICri4uWrh6VI0vvl\nsj0u5zB1r26UYfbAv3vyV8ImbfjFra2JUnWs+zzf102X2cD0CiFnG5qXWQnEoGdg\nY0GbAH+AMjH4Pt9W+aohZ+LpZXjakjPaqF1x61pTy0ApHOrHnprzDxd13jIansoj\nHO4fphkxBJiiXBaCuWrexrLdPJZiYtyuimuMtVBTPnIfFJye8uMB8zV0F6STeSYg\nYDmWcAbyRViyivcoyxQZh/A1WdEV9VmhpltqaZ0CAwEAAaM4MDYwDAYDVR0TAQH/\nBAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJ\nKoZIhvcNAQEFBQADggEBABnHr4qQhoXG9T93ChoyhKvY8dFEe0FPUcUT6zaJxR4F\nuXahQtUEIzXdLZ9ADStMMePNJRj8kAEvwPIyioKppV/AF6Y/Ea8XHm7KNvY+c8FA\nI7lBbfg9azJcrtZGQsSbTuowTQZX1R1jBq1FWZ/bxwn6vnIU75LaYBk5lB2HbwCL\ny4RmHAX73BLPtVnmR3WdI6eUbSt4IPI4FzpLGonwI50vi2bnCTI22OkVtucr8nAh\noXEG+FPAiStqwMaHr8v2I68dAgNk97aQWVULrxZm/LjFh4A+FLK6FpGgITLpbp+I\nzlhFewXrAFp8Up6U3Sch6SCXrtEjDfkyhHbb/j+RtYI=\n-----END CERTIFICATE-----\n"
GOOGLE_PUBLIC_KEYS["fc2c8bb26a78c43bd863705b3d7921b4e6425d54"] = "-----BEGIN CERTIFICATE-----\nMIIDHDCCAgSgAwIBAgIIVKzVWRoMU5UwDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UE\nAxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMjAw\nNTA1MDkxOTU2WhcNMjAwNTIxMjEzNDU2WjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tl\nbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD\nggEPADCCAQoCggEBAOckfYh1/aaqMN8bqvoeDUailhwMUrWUw0wOknS2HLzNUaV1\nLJf0HM3IQ7xBh0W+Obe1HTGNLR/Hp8G1hPKAIdpuGJjmVdNDIg2vm99X1MPi5cXN\nqF9n9JO0l9KeMkkyslGIEuujYuvDXtcgK9FrdN8xxX+eb6N5aqzQSh88TaAJ+JBQ\nAwCIzo2GtdNukVePBH99xCiyMdEFX5yNfK/t6criT2740fekVRw/Si1XmBE2d+Ul\ntiQFuRBLH4XWy46Zb44oGkfgLmzvnQqQh/aF8NXB47TfOa+JeLgj8rnHn3LFgTkr\nkq0q7AuJheofpMzCDCYJd79Eo9/rhN2EAgtY2fUCAwEAAaM4MDYwDAYDVR0TAQH/\nBAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJ\nKoZIhvcNAQEFBQADggEBAB8VhDLUgN6dNiMqs4sevFKQpixCtN8yg6qiRRMtaPQN\n88VETVPXh5acaN83UOOfwtTFZWyZxpSSlWbTI/1E9JJB0GCQX2T7LKm57jHSEeQ9\nmI5ybpRxlm2Jvt7n5sAFHNADSbIdFNEtnGQmh9NVdwe8Zcrzl1NALgeFtiHgvVAe\nuUtKehM+YxK4daNifpkO/e4PNFWgbLJpZtdcG+z+v7DH/9Fwv0JG+Z1RkXjD32iu\niDun3U2W4C7QSnh9cOCbapfkMsXjSA9NvCqUzk1FdnqS9fd8szc389QZGZqQw8WU\nhT9c2fShPT13vgZfNj7fpU2EGBoa3Zu6ybck5pzi0dE=\n-----END CERTIFICATE-----\n"

  
export function verifyIdToken(idToken: string) {
    const parsed = decode(idToken, {complete: true})
    // @ts-ignore
    const kid: string = parsed.header.kid
    const public_key = GOOGLE_PUBLIC_KEYS[kid]

    try {
        const verified = verify(idToken, public_key, {complete: true})
        return verified
    }
    catch(error) {
        // console.log("Error: ", error)
        throw error
    }
}
